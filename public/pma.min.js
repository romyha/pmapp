angular.module("pm",["ionic","starter.controllers","Scope.safeApply","starter.auth"]).run(function(e){e.ready(function(){if(window.cordova&&window.cordova.plugins.Keyboard){cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);cordova.plugins.Keyboard.disableScroll(true)}if(window.StatusBar){StatusBar.styleDefault()}})}).config(function(e,t){e.state("app",{url:"/app","abstract":true,templateUrl:"templates/menu.html",controller:"AppCtrl"}).state("app.camera",{url:"/camera",views:{menuContent:{templateUrl:"templates/camera.html",controller:"cameraCtrl",controllerAs:"vm"}}}).state("app.login",{url:"/login",views:{menuContent:{templateUrl:"templates/login.html",controller:"loginCtrl",controllerAs:"vm"}}}).state("app.register",{url:"/register",views:{menuContent:{templateUrl:"templates/register.html",controller:"RegisterCtrl"}}}).state("app.devices",{url:"/devices",views:{menuContent:{templateUrl:"templates/listing.html",controller:"listingCtrl",controllerAs:"vm"}}}).state("app.device",{url:"/device",views:{menuContent:{templateUrl:"templates/deviceDetail.html",controller:"detailCtrl",controllerAs:"vm"}}}).state("app.changeadd",{url:"/device/change/new",views:{menuContent:{templateUrl:"templates/newChange.html",controller:"changeCtrl",controllerAs:"vm"}}}).state("app.changeedit",{url:"/device/change/edit",views:{menuContent:{templateUrl:"templates/editChange.html",controller:"editChangeCtrl",controllerAs:"vm"}}}).state("app.deviceadd",{url:"/devices/new",views:{menuContent:{templateUrl:"templates/newDevice.html",controller:"addDeviceCtrl",controllerAs:"vm"}}}).state("app.deviceedit",{url:"/device/edit",views:{menuContent:{templateUrl:"templates/editDevice.html",controller:"editDeviceCtrl",controllerAs:"vm"}}}).state("app.help",{url:"/help",views:{menuContent:{templateUrl:"templates/help.html",controller:"helpCtrl",controllerAs:"vm"}}});t.otherwise("/app/devices")});(function(){angular.module("pm").controller("cameraCtrl",function(e,t,a,n,o){var r=this;var l=false;if(!!window.cordova){o.show({template:"Loading..."})}document.addEventListener("deviceready",function(){l=true},false);function s(){screen.lockOrientation("landscape");cordova.plugins.barcodeScanner.scan(function(a){screen.lockOrientation("portrait");var o;if(!a.cancelled){alert("Result: "+a.text+"\n"+"Format: "+"\n"+a.format);t.path("/app/device");e.$apply()}else{o=n.confirm({title:"No device found",template:"Do you want to add one?"});o.then(function(e){if(e){t.path("/app/devices/new")}else{t.path("/app/devices")}}).call()}},function(e){alert("Scanning failed: "+e)})}r.takePic=function(){if(l)s()};e.$on("$ionicView.enter",function(e){if(l){o.hide();s()}else{if(!!window.cordova){o.show({template:"Loading..."})}}});r.goHome=function(){a.nextViewOptions({disableBack:true});t.path("/app/devices");a.nextViewOptions.disableBack=false}})})();(function(){angular.module("pm").controller("helpCtrl",e);function e(e,t){var a=this;a.goHome=function(){e.nextViewOptions({disableBack:true});t.path("/app/devices");e.nextViewOptions.disableBack=false}}})();(function(){angular.module("pm").controller("loginCtrl",e);function e(e,t,a,n,o){var r=this;t.isLoggedIn=o.isLoggedIn();t.loginData={};t.doLogin=function(){t.log="";o.login({email:t.loginData.username,password:t.loginData.password}).error(function(e){t.log=e}).then(function(){t.log="logged";t.isLoggedIn=o.isLoggedIn();n.nextViewOptions({disableBack:true});a.path("/app/devices");n.nextViewOptions.disableBack=false})};r.toRegister=function(){a.path("app/register")};r.asTestUser=function(){t.isLoggedIn=true;e.testMode=true;a.path("/app/devices")}}})();(function(){angular.module("pm").controller("listingCtrl",e);function e(){var e=this;e.devices=[{name:"DC5K A3",id:12345,status:"green"},{name:"DC5K A2",id:2355,status:"yellow"},{name:"DC5K A1",id:897234,status:"green"},{name:"CA11 A.2",id:2309,status:"blue"},{name:"CA11 A.1",id:2345,status:"red"},{name:"C22",id:9823,status:"red"},{name:"DC30 A2",id:9274,status:"yellow"},{name:"DC30 A1",id:628,status:"yellow"},{name:"DC 500",id:94,status:"blue"},{name:"S021",id:9271,status:"green"},{name:"S091",id:90127,status:"red"},{name:"S001",id:9012,status:"blue"}]}})();(function(){angular.module("pm").controller("editChangeCtrl",e);function e(e,t){var a=this;a.addChange=function(){t.nextViewOptions({disableBack:true});e.path("/app/device");t.nextViewOptions.disableBack=false};a.goHome=function(){t.nextViewOptions({disableBack:true});e.path("/app/devices");t.nextViewOptions.disableBack=false}}})();(function(){angular.module("pm").controller("detailCtrl",e);function e(e,t){var a=this;a.device={name:"DC5K A3",id:12345,status:"red",description:"This is a description.",changes:[{author:"Ramin",date:new Date("26 May 2016"),status:"red",message:"Phase C FETs replaced. , phase_B FETs broke and replaced, functional at low voltages. 20160125: the AND chip on C_L was brocken. I shorted it. (2016_01_29) the FETs of phase C are replaced, but there is a short between DC-bus terminals"},{author:"Ramin",date:new Date("21 April 2016"),status:"yellow",message:"I increased the board temperature 3 times (to remove, resolder and fix) the FETs, The board shows short circuit once connected to 13 Volts. Should be investigated, but the board is pretty exhausted!!! I also removed the DC bus diode"},{author:"Victor",date:new Date("20 April 2016"),status:"green",message:"Phase C FETs replaced. , phase_B FETs broke and replaced, functional at low voltages. 20160125: the AND chip on C_L was brocken. I shorted it. (2016_01_29) the FETs of phase C are replaced, but there is a short between DC-bus terminals"},{author:"Ramin",date:new Date("10 March 2016"),status:"green",message:"Phase C FETs replaced. , phase_B FETs broke and replaced, functional at low voltages. 20160125: the AND chip on C_L was brocken. I shorted it. (2016_01_29) the FETs of phase C are replaced, but there is a short between DC-bus terminals"},{author:"Ramin",date:new Date("19 March 2016"),status:"green",message:"Phase C FETs replaced. , phase_B FETs broke and replaced, functional at low voltages. 20160125: the AND chip on C_L was brocken. I shorted it. (2016_01_29) the FETs of phase C are replaced, but there is a short between DC-bus terminals"},{author:"Ramin",date:new Date("1 June 2016"),status:"green",message:"Phase C FETs replaced. , phase_B FETs broke and replaced, functional at low voltages. 20160125: the AND chip on C_L was brocken. I shorted it. (2016_01_29) the FETs of phase C are replaced, but there is a short between DC-bus terminals"},{author:"Ramin",date:new Date("10 March 2016"),status:"green",message:"Phase C FETs replaced. , phase_B FETs broke and replaced, functional at low voltages. 20160125: the AND chip on C_L was brocken. I shorted it. (2016_01_29) the FETs of phase C are replaced, but there is a short between DC-bus terminals"}]};a.goHome=function(){t.nextViewOptions({disableBack:true});e.path("/app/devices");t.nextViewOptions.disableBack=false};a.toEdit=function(){e.path("/app/device/change/edit")}}})();(function(){angular.module("pm").controller("changeCtrl",e);function e(e,t){var a=this;a.addChange=function(){t.nextViewOptions({disableBack:true});e.path("/app/device");t.nextViewOptions.disableBack=false};a.changeColor=function(){switch(a.selector){case"green":{a.color="lawngreen";break}case"yellow":{a.color="yellow";break}case"blue":{a.color="deepskyblue";break}case"red":{a.color="orangered";break}default:{a.color="none";break}}};a.goHome=function(){t.nextViewOptions({disableBack:true});e.path("/app/devices");t.nextViewOptions.disableBack=false}}})();(function(){angular.module("pm").controller("addDeviceCtrl",e);function e(e,t){var a=this;a.addChange=function(){t.nextViewOptions({disableBack:true});e.path("/app/device");t.nextViewOptions.disableBack=false};a.changeColor=function(){switch(a.selector){case"green":{a.color="lawngreen";break}case"yellow":{a.color="yellow";break}case"blue":{a.color="deepskyblue";break}case"red":{a.color="orangered";break}default:{a.color="none";break}}};a.goHome=function(){t.nextViewOptions({disableBack:true});e.path("/app/devices");t.nextViewOptions.disableBack=false}}})();(function(){angular.module("starter.auth",["ngResource"]).factory("authentication",e);e.$inject=["$window","$http"];function e(e,t,a){var n="http://192.168.0.30:5000/api";var o=function(t){e.localStorage["loc8r-token"]=t};var r=function(){return e.localStorage["loc8r-token"]};var l=function(){var t=r();if(t){var a=JSON.parse(e.atob(t.split(".")[1]));return a.exp>Date.now()/1e3}else return false};var s=function(){if(l()){var t=r();var a=JSON.parse(e.atob(t.split(".")[1]));return{email:a.email,name:a.name}}};register=function(e){return t.post(n+"/register",e).success(function(e){o(e.token)})};login=function(e){var a={"Access-Control-Allow-Origin":"*"};var r={data:e,url:n+"/login",method:"POST"};return t(r).success(function(e){o(e.token);console.log("logged in")})};logout=function(){e.localStorage.removeItem("loc8r-token")};return{saveToken:o,getToken:r,isLoggedIn:l,currentUser:s,login:login,register:register,logout:logout}}})();(function(){angular.module("pm").service("deviceData",e);function e(e){var t="http://192.168.0.30:5000/api";var a=function(a){return e.get(t+"/devices/"+a)}}})();